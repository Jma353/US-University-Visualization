<!DOCTYPE html> 
<html>
	<head>
		<style>


			html {
				font-family: Helvetica; 
			}

			svg {
				fill: #B58AA5; /* Purple fill */
				stroke: white; /* White path */
			}


		</style> 
	</head> 

	<body>

		<!-- Where the map goes --> 
		<div class="us-map">

		</div> 


		
		<script src="d3/d3.min.js"></script> 
		<script src="http://d3js.org/topojson.v0.min.js"></script>
		<!-- Start of JS --> 
		<script>

			// Map guide used: 
			// https://bl.ocks.org/mbostock/4090848



			// Assign dimensions of SVG element 
			var width = 2500; 
			var height = 1500; 

			// Set the projection, based on the fact that we're using a US map 
			var projection = d3.geo.albersUsa().scale(2500).translate([width / 2, height / 2]); 

			// Set the path based on this projection 
			var path = d3.geo.path().projection(projection); 

			// SVG element 
			var svg = d3.select(".us-map").append("svg").attr("width", width).attr("height", height); 

			// load the map JSON 
			d3.json("us-states.json", function(error, json) {

				if (error) throw error; 

				svg.selectAll("path")
					.data(json.features)
					.enter()
					.append("path")
					.attr("d", path)
					.on("mouseover", function(d) {
						d3.selectAll("path").style("fill", "#B58AA5"); // Set all equal to this color 
						d3.select(this).style("fill", "#E39AB2"); // Set the most recent to this color 
						var stateName = d["properties"]["name"]; 
						var unis = []; 
						var circles = d3.selectAll("circle"); 
						circles.forEach(function(d) {
							console.log(d); 
						}); 
					}); 

			}); 

			var phoneData; 

			// load the universities 
			d3.json('scripts/tests/overall_with_state.json', function(error, data) {
					
				// Mapping inspiration taken from 
				// http://chimera.labs.oreilly.com/books/1230000000345/ch12.html#_adding_points

				// Radii for various situations 
				var defCircleR = 3; 
				var largeCircleR = 10; 

				// Set the data of the 
				phoneData = data; 

				svg.selectAll("circle")
					.data(data)
					.enter()
					.append("circle")
					.attr("cx", function(d) {
						var lat = d["location_info"]["lat"]; 
						var lng = d["location_info"]["lng"]; 
						return projection([lng, lat])[0]; 
					})
					.attr("cy", function(d) {
						var lat = d["location_info"]["lat"]; 
						var lng = d["location_info"]["lng"]; 
						return projection([lng, lat])[1]; 
					})
					.attr("r", defCircleR)
					.attr("data", function(d) {
						return data.indexOf(d); // Return the index of the data we care about
					})
					.style("fill", "#825A6C")
					.on("mouseover", function(d) {
						d3.select(this).transition().duration(500).attr("r", largeCircleR); 
						console.log(d); 
					})
					.on("mouseleave", function(d) {
						d3.select(this).transition().duration(500).attr("r", defCircleR)
					}); 

			
			}); 



		</script> 



	</body> 




</html> 





