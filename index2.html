<html>
    <head>
        <style>
            body{background-color:black;}
            path {
                stroke:grey/*steelblue*/;
                stroke-width: 1px;
                fill:#f2f2f2;/*#EBEBE0;*/
            }
            #projecttitle{
             color:white/*#4d88ff*/;
             font-size:200%;
             font-family:serif;
             text-align:center;
            
            }
            #userselect{text-align:center; color:white;}
            #collegeinfo{
            margin-left:7%;
            width:18%;
            display:inline-block;
            vertical-align: top;
            }

            #credits{
            font-size:50%;
            position: fixed;
            bottom: 0;
color:white;
            }

            #float-button-group {
                position:fixed;
                left:26%;
                opacity:0.5;
            }

            #float-button-group:hover {
                opacity:1;
            }
            #centroidsDisplay{background-color:white; color:white;}
.centroidsDisplay{color:white;display:inline-block; width:50px;}
            #map {
             
                background: black;
                margin:auto;
       position: absolute;
       top: 20; 
       left: 0;
       bottom: 0; 
       right: 0;
                width:1300px; 
                height: 650px;
                /*display:inline-block;*/
            }
            #map svg:hover{cursor:grab;}
            

        </style>
    </head>
    <body>
        <div id="projecttitle">Project 2</div>
        <div id="userselect">Select criteria: 
               
                <input type="checkbox" name="criteria" value="pripub" checked >Private vs. Public</input>
                <input type="checkbox" name="criteria" value="avgactsat">Average ACT/SAT Score</input>
                <input type="checkbox" name="criteria" value="avgsal">Average Graduate Salary</input>
                <input type="checkbox" name="criteria" value="tuition">Tuition</input>
                <input type="checkbox" name="criteria" value="accrate">Acceptance Rate</input>
         
        </div>
       
        <div id="map">
            
           <!-- <div class="btn-group-vertical" role="group" aria-label="..." id="float-button-group">
                <button type="button" class="btn btn-default" id="zoom-in">+</button>
                <button type="button" class="btn btn-default" id="zoom-out">-</button>
                <button type="button" class="btn btn-default" id="reset">o</button>
            </div>-->
            <!--<input type="range" value="1" min="1" max="8" orient="vertical" id="map-zoomer"/>-->
             <svg width="1300" height="650"></svg>
            
        </div>
        <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <!--<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>-->
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="http://d3js.org/topojson.v0.min.js"></script>
        <!--for zoom buttons-->
        <script>


            var width = d3.select('#map').node().getBoundingClientRect().width;
            var height = d3.select('#map').node().getBoundingClientRect().height;

            var center = [width / 2, height / 2];
var initialMarginLeft=120;
            var projection = d3.geo.albersUsa().scale(1100).translate([width/2,height/2.5]);
            
            var svg = d3.select("svg")/*("#map")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)*/;

            var path = d3.geo.path()
                    .projection(projection);

            //var g = svg.append("g");

            d3.json("us.json", function (error, topology) {
                svg.selectAll("path")
                        .data(topojson.object(topology, topology.objects.states).geometries)
                        .enter()
                        .append("path")
                        .attr("d", path);

                /*d3.csv("cities.csv", function (error, cities) {

                    svg.selectAll("circle")
                            .data(cities)
                            .enter()
                            .append("circle")
                            .attr("cx", function (d) {
                                return projection([d.lon, d.lat])[0];
                            })
                            .attr("cy", function (d) {
                                return projection([d.lon, d.lat])[1];
                            })
                            .attr("r", 5)
                            .style("fill", "red");
                });*/
//g.attr("transform", "translate(" + initialMarginLeft + "," + 0 + ")"+ "scale(" + 1.1 + ")");
//d3.selectAll("path").attr("transform", "translate(" + initialMarginLeft + "," + 0 + ")"+ "scale(" + 1.1 + ")");

  

var ithacaCoords = projection([-76, 42]);
	svg.append("circle").attr("cx", ithacaCoords[0])
	.attr("cy", ithacaCoords[1])
	.attr("r", 3).style("fill","brown");
        svg.append("text").attr("x", ithacaCoords[0])
	.attr("y", ithacaCoords[1]+10)
	.text("university").attr("text-anchor","middle").style("fill","red");



svg.append("circle").attr("cx", 1200)
	.attr("cy", 250)
	.attr("r", 4).style("fill","red");
        svg.append("text").attr("x", 1208)
	.attr("y", 258)
	.text("Centroid").attr("text-anchor","middle").style("fill","red");



var lCoords = projection([-65, 40]);//970,225
svg.append("line").attr("x1", 1200)
	.attr("y1", 250)
	.attr("x2", ithacaCoords[0]).attr("y2", ithacaCoords[1]).attr("stroke-width", 2).attr("stroke", "red");

var lCoords2 = projection([-125, 25]);
g.append("line").attr("x1", lCoords2[0])
	.attr("y1", lCoords2[1])
	.attr("x2", ithacaCoords[0]).attr("y2", ithacaCoords[1]).attr("stroke-width", 2).attr("stroke", "red");

//g.append("rect").attr("x",0).attr("y",0).attr("width",100).attr("height",500);

//d3.selectAll("circle").attr("transform", "translate(" + initialMarginLeft + "," + 0 + ")");


            });











            var zoom = d3.behavior.zoom()
                    .scaleExtent([1, 8])
                    .on("zoom", function () {
                        g.attr("transform", "translate(" + d3.event.translate.join(",") + ") scale(" + d3.event.scale + ")");
                        g.selectAll("path")
                                .attr("d", path.projection(projection));
                        
                       /* svg.selectAll("circle")
                                .attr("transform", "translate(" + d3.event.translate.join(",") + ") scale(" + d3.event.scale + ")")
                                .transition()/duration(200)
                                .attr("r", 5 / d3.event.scale);*/
                        /*d3.select("#map-zoomer").node().value = zoom.scale();*/
                    });
           svg.call(zoom);


           d3.select('#zoom-in').on('click', function () {
                var scale = zoom.scale(), extent = zoom.scaleExtent(), translate = zoom.translate();
                var x = translate[0]+initialMarginLeft, y = translate[1];
                var factor = 1.2;

                var target_scale = scale * factor;

                if (scale === extent[1]) {
                    return false;
                }
                var clamped_target_scale = Math.max(extent[0], Math.min(extent[1], target_scale));
                if (clamped_target_scale != target_scale) {
                    target_scale = clamped_target_scale;
                    factor = target_scale / scale;
                }
                x = (x - center[0]) * factor + center[0];
                y = (y - center[1]) * factor + center[1];

                zoom.scale(target_scale).translate([x, y]);

                g.transition().attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")");
                g.selectAll("path")
                        .attr("d", path.projection(projection));

                /*svg.selectAll("circle")
                        .transition()
                        .attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")")
                        .attr("r", 5 / zoom.scale());*/

                /*d3.select("#map-zoomer").node().value = zoom.scale();*/
            });

            d3.select('#zoom-out').on('click', function () {
                var scale = zoom.scale(), extent = zoom.scaleExtent(), translate = zoom.translate();
                var x = translate[0], y = translate[1];
                var factor = 1 / 1.2;

                var target_scale = scale * factor;

                if (scale === extent[0]) {
                    return false;
                }
                var clamped_target_scale = Math.max(extent[0], Math.min(extent[1], target_scale));
                if (clamped_target_scale != target_scale) {
                    target_scale = clamped_target_scale;
                    factor = target_scale / scale;
                }
                x = (x - center[0]) * factor + center[0];
                y = (y - center[1]) * factor + center[1];

                zoom.scale(target_scale).translate([x, y]);

                g.transition()
                        .attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")");
                g.selectAll("path")
                        .attr("d", path.projection(projection));

                /*svg.selectAll("circle")
                        .transition()
                        .attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")")
                        .attr("r", 5 / zoom.scale());*/
                /*d3.select("#map-zoomer").node().value = zoom.scale();*/
            });

            d3.select('#reset').on('click', function () {
                zoom.translate([0, 0]);
                zoom.scale(1);
                g.transition().attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")");
                g.selectAll("path")
                        .attr("d", path.projection(projection))

                /*svg.selectAll("circle")
                        .transition()
                        .attr("transform", "translate(" + zoom.translate().join(",") + ") scale(" + zoom.scale() + ")")
                        .transition()
                        .attr("r", 5 / zoom.scale());*/
                /*d3.select("#map-zoomer").node().value = zoom.scale();*/
            }); 


        </script>
<div id="credits">Code inspired by: http://bl.ocks.org/nivas8292</div>
    </body>

</html>